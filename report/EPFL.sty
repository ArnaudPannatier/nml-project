\NeedsTeXFormat{LaTeX2e}
% Adapted from [official EPFL template](https://www.epfl.ch/campus/services/communication/en/visual-communication/)
\ProvidesPackage{EPFL}[2022/05/29 v0.1]
\RequirePackage{graphicx,color,helvet}
\newif\ifc@rporate
\newif\ifwind@w
%\definecolor{epflred}{rgb}{0.890196, 0.0235294, 0.07498}
\definecolor{epflred}{rgb}{1,0,0}
\def\epflletterbw{%
	\def\epfll@go{logos/EPFLlogobw}%
	\def\epflc@rp{logos/EPFLcorpbw}%
	\def\setrulec@lor{\relax}}
\def\epflletternobw{%
	\def\epfll@go{logos/EPFLlogo}%
	\def\epflc@rp{logos/EPFLcorp}%
	\def\setrulec@lor{\color{epflred}}}
\def\epflletterwindow{\wind@wtrue}
\def\epflletternowindow{\wind@wfalse}
\def\epfllettercorporate{\c@rporatetrue}
\def\epflletternocorporate{\c@rporatefalse}
\epflletternobw\epflletternowindow\epflletternocorporate
%
\DeclareOption{bw}{\epflletterbw}
\DeclareOption{corporate}{\epfllettercorporate}
\DeclareOption{window}{\epflletterwindow}
\ProcessOptions
%

\def\unitname#1#2#3{
  \def\unitnamefoot{#1}
  \def\unitnameheadbf{#2}
  \def\unitnameheadmd{#3}
}
\unitname{}{}{}

\newcommand{\course}[2]{
	\def\@course{#1}
	\def\@fullcourse{#2}
}
\usepackage[font={scriptsize,bf}]{caption}

%
\def\texthelvet{\fontfamily{phv}\selectfont}
\def\tenp@int{\@setfontsize\tenp@int\@xpt\@xiipt}
\def\eightp@int{\@setfontsize\eightp@int\@viiipt{9.5}}
%
\let\@texttop\relax
%
\newlength\@articleheadraise
\newlength\@articlefootraise
\newlength\@articleheadshift
\newlength\@articleheadwidth
\newlength\@articleheadmargin\@articleheadmargin=20mm
\newlength\l@goheight\l@goheight=10mm
\newlength\l@gowidth\l@gowidth=3.4402778\l@goheight
\newlength\wind@wwidth
%
\def\epflmargins{%
	\oddsidemargin=-1in%
	\addtolength\oddsidemargin\@articleheadmargin%
	\addtolength\oddsidemargin\l@gowidth%
	\textwidth=\paperwidth%
	\addtolength\textwidth{-\oddsidemargin}%
	\addtolength\textwidth{-\@articleheadmargin}%
	\addtolength\textwidth{-1in}%
	\onecolumn}
\def\narrowmargins{%
	\oddsidemargin=13.4mm
	\textwidth=\paperwidth%
	\addtolength\textwidth{-20mm}%
	\addtolength\textwidth{-1in}%
	\addtolength\textwidth{-\oddsidemargin}%
	\onecolumn}
\def\symmetricmargins{%
	\oddsidemargin=\paperwidth%
	\addtolength\oddsidemargin{-\textwidth}%
	\oddsidemargin=.5\oddsidemargin%
	\addtolength\oddsidemargin{-1in}%
	\onecolumn}
\epflmargins
\topmargin=0pt
\textheight=\paperheight
\addtolength\textheight{-80mm}
\addtolength\textheight{-\topmargin}
%
\def\c@lculatedimens{%
	\@articleheadwidth=\paperwidth%
	\addtolength\@articleheadwidth{-2\@articleheadmargin}%
	\@articleheadshift=-1in%
	\addtolength\@articleheadshift{-\oddsidemargin}%
	\addtolength\@articleheadshift\@articleheadmargin%
	\@articleheadraise=1in%
	\addtolength\@articleheadraise\topmargin%
	\addtolength\@articleheadraise\headheight%
	\addtolength\@articleheadraise{-\l@goheight}%
	\addtolength\@articleheadraise{-10mm}%
	\wind@wwidth=\paperwidth%
	\addtolength{\wind@wwidth}{-142mm}%
	\@articlefootraise=1in%
	\addtolength\@articlefootraise\topmargin%
	\addtolength\@articlefootraise\headheight%
	\addtolength\@articlefootraise\headsep%
	\addtolength\@articlefootraise\textheight%
	\addtolength\@articlefootraise\footskip%
	\addtolength\@articlefootraise{-\paperheight}%
	\addtolength\@articlefootraise{21mm}}
%
\def\firstfoot{%
	\c@lculatedimens%
	\hspace*{\@articleheadshift}%
	\raisebox{\@articlefootraise}[0pt][0pt]{%
		\makebox[\@articleheadwidth][l]{
			\texthelvet\eightp@int%
			\makebox[0pt][r]{\setrulec@lor\rule{6.1pt}{5.6pt}\hspace*{5.6pt}}%
			\makebox[1.2\l@gowidth][l]{%
				\ifc@rporate%
					\includegraphics[viewport=5 176 337 221, width=0.596\l@gowidth]{\epflc@rp}%
				\else%
					\begin{bfseries}
          			\begin{tabular}[t]{@{}l@{}}
							\unitnamefoot \\
							\unitnameheadbf \\
							\unitnameheadmd
         		 	\end{tabular}
          		 	\end{bfseries}%
				\fi}%
				\ifc@rporate%
				\begin{bfseries}
				\begin{tabular}[t]{@{}l@{}}
						\unitnamefoot
				\end{tabular}
				\end{bfseries}
				\hss%
				\fi%
      			\begin{tabular}[t]{@{}l@{}}
		 			\@course : \@fullcourse \\
      				\@title \\
      				\@date
      			\end{tabular}
				\hspace*{20pt}
				\begin{tabular}[t]{@{}l@{}}
					Arnaud Pannatier \\
					arnaud.pannatier@epfl.ch \\
					arnaudpannatier.ch \\
				\end{tabular}
		}

  
			\hspace*{-.3pt}\raisebox{-33pt}{\texthelvet\eightp@int%
			\rule{.3pt}{44pt}\makebox[0pt][l]{\hspace*{3pt}\thepage}}%
	}
  \hss
}
\def\c@mmonfoot{%
	\c@lculatedimens%
	\hspace*{\@articleheadshift}%
	\raisebox{\@articlefootraise}[0pt][0pt]{%
		\makebox[\@articleheadwidth][l]{
			\texthelvet\eightp@int%
			\makebox[0pt][r]{\setrulec@lor\rule{6.1pt}{5.6pt}\hspace*{5.6pt}}%
			\makebox[1.2\l@gowidth][l]{%
				\ifc@rporate%
					\includegraphics[viewport=5 176 337 221, width=0.596\l@gowidth]{\epflc@rp}%
				\else%
					\begin{bfseries}
          			\begin{tabular}[t]{@{}l@{}}
							\unitnamefoot \\
							\unitnameheadbf \\
							\unitnameheadmd
         		 	\end{tabular}
          		 	\end{bfseries}%
				\fi}%
				\ifc@rporate%
				\begin{bfseries}
				\begin{tabular}[t]{@{}l@{}}
						\unitnamefoot
				\end{tabular}
				\end{bfseries}
				\hss%
				\fi%

		}
			\hspace*{-.3pt}\raisebox{-33pt}{\texthelvet\eightp@int%
			\rule{.3pt}{44pt}\makebox[0pt][l]{\hspace*{3pt}\thepage}}%
	}
  \hss
}

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Article

%
\def\ps@EPFLarticlefirst{%
	\def\@oddhead{%
		\c@lculatedimens%
		\hspace*{\@articleheadshift}\raisebox{\@articleheadraise}[0pt][0pt]{%
			\makebox[\@articleheadwidth][l]{
				\texthelvet\tenp@int%\bfseries%
				\includegraphics[height=\l@goheight]{\epfll@go}%
			}
		}
		\hss}%
	\let\@oddfoot\firstfoot
}

\def\ps@EPFLarticle{%
	\def\@oddhead{%
		\c@lculatedimens%
		\hspace*{\@articleheadshift}
    	\raisebox{\@articleheadraise}[0pt][0pt]{%
			\makebox[\@articleheadwidth][l]{
        		\texthelvet\tenp@int\bfseries
				\raisebox{0.3\l@goheight}{
					\includegraphics[height=.7\l@goheight]{\epfll@go}
				}
      		}
    		}
        \hss}%
	\let\@oddfoot\c@mmonfoot
}

\newcommand{\subtitle}[1]{
	\def\thesubtitle{#1}
}

\usepackage[document]{ragged2e}
\usepackage{anyfontsize}
\usepackage{titling}
\usepackage{amsfonts}
\usepackage{xcolor}
\providecommand{\maketitle}{}
\renewcommand{\maketitle}{%
	\thispagestyle{EPFLarticlefirst}
	\centering
	\vspace*{1cm}
	\parbox{13cm}{ 
		\centering
		{\fontsize{35}{60}\selectfont\bfseries\thetitle} \\
		\vspace*{3mm}

		\justifying\Large\color{epflred}\bfseries\@course.\color{black} \normalfont \thesubtitle
	}
	\vspace*{1cm}
	\normalfont\normalsize
	\justifying
}

\definecolor{blue}{HTML}{2980b9}
\definecolor{gray}{HTML}{7f8c8d}
\definecolor{green}{HTML}{16a085}
\definecolor{orange}{HTML}{d35400}
\definecolor{purple}{HTML}{8e44ad}
\definecolor{red}{HTML}{c0392b}

\pagestyle{EPFLarticle}
\def\familydefault{\sfdefault}